# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** 涂若晗 **学号：** 20231050207 **完成日期：** 2025/6/18

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# FTCS主算法
    for n in range(1, t.size - 1):
        for i in range(1, x.size - 1):
            u[i, n + 1] = c * (u[i + 1, n] + u[i - 1, n]) + 2 * (1 - c) * u[i, n] - u[i, n - 1]
        # 应用边界条件
        u[0, n + 1] = 0  # 左端点边界条件
        u[-1, n + 1] = 0  # 右端点边界条件
```

## 3. 实验结果

### 3.1 主要输出


[![wave_equation_ftcs_animation-1](https://github.com/user-attachments/assets/c7d47f4d-77b6-4044-8c55-e14c99f5b647)](https://github.com/Xianghua-YNU/cp2025-practices-week17-007/blob/4e1f345f05b5d3ff6aa7deeb911b8e5cfe918a3e/WaveEquationFTCS/wave_equation_ftcs_animation.gif)






成功实现了波动方程的数值求解并生成了弦振动动画。动画显示：
- 初始时刻弦处于静止状态（零位移）
- 振动从 $x=0.1m$ 附近开始激发
- 波以速度 $a=100m/s$ 向两端传播
- 遇到固定边界后发生反射并形成干涉图案
- 随时间推移，振动能量在整个弦上分布
### 3.2 结果验证

1. **边界条件**：所有时间步中端点位移严格保持为零
2. **初始条件**：$t=0$ 时位移为零，$t=\Delta t$ 时位移与初始速度剖面一致
3. **稳定性**：使用 $\Delta x=0.01m, \Delta t=5\times10^{-5}s$ 时 $c=0.25<1$，模拟稳定无振荡
4. **波形特征**：观察到预期的行波传播、反射和叠加现象

## 4. 问题与收获

### 4.1 主要问题

1. **初始速度处理**：如何将连续初始速度 $\psi(x)$ 正确离散到第一个时间步
2. **稳定性控制**：时间步长选择不当导致数值发散
3. **边界实现**：迭代中确保端点位移恒为零

### 4.2 解决方法

1. 通过 $u_i^1 \approx \psi(x_i)\Delta t$ 实现初始速度的离散化
2. 严格遵守CFL条件 $a\Delta t/\Delta x < 1$ 选择时间步长
3. 每步迭代后显式设置 $u_0^{n+1}=u_{N_x}^{n+1}=0$

### 4.3 主要收获

1. 深入理解了波动方程的数值求解原理和FTCS方案的实现细节
2. 掌握了科学计算中关键概念：离散化、稳定性条件、边界处理
3. 实践了Python数值计算（NumPy）和科学可视化（Matplotlib）工作流
4. 认识到物理参数（波速、初始条件）对振动模式的显著影响
5. 体会到数值方法中精度与计算效率的平衡关系
## 5. 思考题（可选）

1. **初始速度剖面变化**：改变 $\psi(x)$ 的形状会显著改变振动模式。例如：
   - 窄高斯剖面产生局域化波包
   - 对称剖面产生驻波模式
   - 多峰剖面导致复杂干涉
2. **步长影响**：
   - $\Delta t$ 过大（$c \geq 1$）：解振荡发散
   - $\Delta x$ 过大：波形分辨率不足
   - 同时减小 $\Delta t$ 和 $\Delta x$：提高精度但增加计算成本
