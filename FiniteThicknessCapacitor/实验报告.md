# 项目：有限厚平行板电容器电荷分布分析 - 实验报告

**学生姓名：** 雷翊烜 **学号：** 20231130155 **完成日期：** 2025.6.18

## 1. 实验目的

[请用1-2句话描述本实验的学习目标和要解决的物理问题]
通过用有限差分法求解有限厚平行板电容器的电势分布，利用泊松方程计算电荷密度并可视化电场，研究有限厚度对电场和电荷分布的影响 。
## 2. 核心算法

### 2.1 算法思路

[请用3-5句话描述SOR迭代法求解拉普拉斯方程的基本思路和实现步骤]
SOR迭代法解拉普拉斯方程，先初始化电势网格与导体掩码，设边界及极板电势。迭代时，对非导体内部点，依SOR公式（结合松弛因子，由四邻点电势加权更新当前点）更新电势，监测最大误差，若小于容差则收敛，否则达最大迭代次数停止，以此求解电势分布 。 
### 2.2 关键代码片段

```python
# 请粘贴你认为最重要的核心代码段（如SOR迭代部分）
for iteration in range(max_iter):
    U_old = U.copy()
    max_error = 0.0
    for i in range(1, ny-1):
        for j in range(1, nx-1):
            if not conductor_mask[i, j]:  
                U_new = 0.25 * (U[i+1, j] + U[i-1, j] + U[i, j+1] + U[i, j-1])
                U[i, j] = (1 - omega) * U[i, j] + omega * U_new
                error = abs(U[i, j] - U_old[i, j])
                max_error = max(max_error, error)
    if max_error < tolerance:
        print(f"Converged after {iteration + 1} iterations")
        break
```

## 3. 实验结果

### 3.1 主要输出

[请描述你的程序输出的关键数值结果，如收敛迭代次数、电势范围、电荷分布特征等]
电势范围是 200.00V（最小 - 100V 、最大 100V ）；电荷分布特征为最大电荷密度 26342.265595，正负总电荷绝对值均为 129.493936，总电荷为 0，符合电荷守恒，反映有限厚平行板电容器电荷分布及电势情况 。
![image](https://github.com/user-attachments/assets/a493a0f5-6d18-4036-bbfb-a20bde36b745)

### 3.2 结果验证

[请说明如何验证你的结果是正确的，如边界条件检查、物理合理性分析等]
1. 边界条件检查：查看上下极板、接地边界的电势是否符合设定（上极板100V、下极板-100V，左右及上下边界0V ），若符合则边界条件施加正确。
2. 物理合理性分析：依据电荷守恒，总电荷应接近0（程序输出总电荷0.000000 ），验证电荷分布合理性；电势分布应随极板位置及距离渐变，结合3D图看是否符合电场规律，如极板间电势线性变化趋势（理想情况近似），以此判断结果物理合理 。 
## 4. 问题与收获

### 4.1 主要问题

[请描述在实现过程中遇到的1-2个主要困难或问题]
在实现过程中，一是迭代收敛问题，SOR迭代法里松弛因子难选，选得不合适会让收敛慢甚至不收敛，得反复调试；二是电荷密度计算，用拉普拉斯算子数值计算时，网格划分和边界处理易使结果有误差，要精细调整参数、校验算法，保证物理量计算准确 。
### 4.2 解决方法

[请描述你是如何解决上述问题的，包括调试方法和解决思路]
1. 迭代收敛问题：先查资料确定松弛因子经验范围（如1.5 - 2.0 ），用循环遍历测试不同因子，结合迭代误差变化选最优值；迭代时监测误差，若难收敛，调整因子或优化迭代终止条件。  
2. 电荷密度误差问题：核对拉普拉斯算子计算逻辑，对比理论公式修正代码；细化网格减小离散误差，校验边界条件处理，用简单场景（如均匀电场）手动算结果对比调试，定位修正错误 。
### 4.3 主要收获

[请用3-5句话总结通过本实验学到的知识和技能]
掌握了用SOR迭代法求解拉普拉斯方程的流程，学会借助Python实现电势与电荷密度的计算，理解有限厚平行板电容器电荷分布的物理规律，提升了数值模拟与结果可视化的实操技能，强化了物理问题数值求解的思维。
## 5. 思考题（可选）

### 5.1 松弛因子影响分析

[请分析不同松弛因子ω对收敛速度的影响，并解释原因]
松弛因子\(\omega\)影响收敛速度：\(\omega = 1\)为高斯 - 赛德尔迭代，收敛慢；\(1 < \omega < 2\)（超松弛）时，合适\(\omega\)可加速，因利用前次迭代信息，加快误差修正；\(\omega \geq 2\)可能不收敛，破坏迭代稳定性。 
### 5.2 有限厚度效应

[请对比分析有限厚度与理想薄板电容器在电场分布上的差异]
理想薄板电容器极板无厚度，电场仅集中于极板间，均匀且边缘效应弱，电场线垂直极板；有限厚度时，极板内部电势恒定，边缘电场线弯曲，出现边缘效应，极板边缘电场强度更大，分布更复杂，因厚度使电场在极板内、外及边缘的分布受几何结构影响。 
### 5.3 数值精度讨论

[请讨论网格分辨率对计算精度的影响，以及如何平衡精度与计算效率]
网格分辨率越高，计算精度通常越好，能更细致呈现电场、电势等分布细节，减少离散误差；但会增加计算量，拖慢效率。平衡时，可先粗网格快速算初值，再局部加密关键区域（如极板边缘）；或根据需求定精度目标，测试不同分辨率，选满足精度且计算时间可接受的网格，兼顾结果质量与效率。
